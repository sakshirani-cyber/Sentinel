spring.application.name=sentinel-backend

spring.datasource.url=${DB_URL}
spring.datasource.username=${DB_USERNAME}
spring.datasource.password=${DB_PASSWORD}
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=none
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.open-in-view=false

spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.idle-timeout=30000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.connection-timeout=20000

spring.data.redis.master.host=${REDIS_MASTER_HOST:localhost}
spring.data.redis.master.port=${REDIS_MASTER_PORT:6379}
spring.data.redis.master.password=${REDIS_MASTER_PASSWORD:}

spring.data.redis.slave.host=${REDIS_SLAVE_HOST:localhost}
spring.data.redis.slave.port=${REDIS_SLAVE_PORT:6380}
spring.data.redis.slave.password=${REDIS_SLAVE_PASSWORD:}

redisson.config-file=classpath:redisson.yaml

cache.poll.ttl.minutes=60
cache.poll.results.ttl.minutes=5
cache.sse.events.ttl.hours=24

async.db.sync.enabled=true

resilience4j.circuitbreaker.instances.redis.failure-rate-threshold=50
resilience4j.circuitbreaker.instances.redis.wait-duration-in-open-state=30s
resilience4j.circuitbreaker.instances.redis.sliding-window-size=10

resilience4j.circuitbreaker.instances.database.failure-rate-threshold=50
resilience4j.circuitbreaker.instances.database.wait-duration-in-open-state=30s
resilience4j.circuitbreaker.instances.database.sliding-window-size=10

resilience4j.retry.instances.database.max-attempts=3
resilience4j.retry.instances.database.wait-duration=500ms
resilience4j.retry.instances.database.retry-exceptions=java.net.ConnectException,java.sql.SQLTransientConnectionException,org.springframework.dao.QueryTimeoutException,org.springframework.dao.TransientDataAccessException
resilience4j.retry.instances.database.ignore-exceptions=org.springframework.dao.DataIntegrityViolationException,org.springframework.dao.DuplicateKeyException,jakarta.validation.ConstraintViolationException

executor.core-pool-size=20
executor.max-pool-size=100
executor.queue-capacity=1000
executor.thread-name-prefix=async-executor-

scheduler.pool-size=10

management.endpoints.web.exposure.include=health,metrics,prometheus
management.metrics.export.prometheus.enabled=true